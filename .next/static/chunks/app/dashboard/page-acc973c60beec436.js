(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{4213:function(e,t,n){Promise.resolve().then(n.bind(n,3513))},3513:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var s=n(7437),i=n(2265),a=n(9376),l=n(8881),o=n(3576),r=n(4252),d=n(5750);class c extends i.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function u(e){let{children:t,isPresent:n}=e,a=(0,i.useId)(),l=(0,i.useRef)(null),o=(0,i.useRef)({width:0,height:0,top:0,left:0}),{nonce:r}=(0,i.useContext)(d._);return(0,i.useInsertionEffect)(()=>{let{width:e,height:t,top:s,left:i}=o.current;if(n||!l.current||!e||!t)return;l.current.dataset.motionPopId=a;let d=document.createElement("style");return r&&(d.nonce=r),document.head.appendChild(d),d.sheet&&d.sheet.insertRule('\n          [data-motion-pop-id="'.concat(a,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(s,"px !important;\n            left: ").concat(i,"px !important;\n          }\n        ")),()=>{document.head.removeChild(d)}},[n]),(0,s.jsx)(c,{isPresent:n,childRef:l,sizeRef:o,children:i.cloneElement(t,{ref:l})})}let h=e=>{let{children:t,initial:n,isPresent:a,onExitComplete:l,custom:d,presenceAffectsLayout:c,mode:h}=e,m=(0,o.h)(p),x=(0,i.useId)(),f=(0,i.useCallback)(e=>{for(let t of(m.set(e,!0),m.values()))if(!t)return;l&&l()},[m,l]),g=(0,i.useMemo)(()=>({id:x,initial:n,isPresent:a,custom:d,onExitComplete:f,register:e=>(m.set(e,!1),()=>m.delete(e))}),c?[Math.random(),f]:[a,f]);return(0,i.useMemo)(()=>{m.forEach((e,t)=>m.set(t,!1))},[a]),i.useEffect(()=>{a||m.size||!l||l()},[a]),"popLayout"===h&&(t=(0,s.jsx)(u,{isPresent:a,children:t})),(0,s.jsx)(r.O.Provider,{value:g,children:t})};function p(){return new Map}var m=n(9637);let x=e=>e.key||"";function f(e){let t=[];return i.Children.forEach(e,e=>{(0,i.isValidElement)(e)&&t.push(e)}),t}var g=n(1534);let b=e=>{let{children:t,custom:n,initial:a=!0,onExitComplete:r,presenceAffectsLayout:d=!0,mode:c="sync",propagate:u=!1}=e,[p,b]=(0,m.oO)(u),y=(0,i.useMemo)(()=>f(t),[t]),k=u&&!p?[]:y.map(x),j=(0,i.useRef)(!0),v=(0,i.useRef)(y),w=(0,o.h)(()=>new Map),[N,C]=(0,i.useState)(y),[S,L]=(0,i.useState)(y);(0,g.L)(()=>{j.current=!1,v.current=y;for(let e=0;e<S.length;e++){let t=x(S[e]);k.includes(t)?w.delete(t):!0!==w.get(t)&&w.set(t,!1)}},[S,k.length,k.join("-")]);let E=[];if(y!==N){let e=[...y];for(let t=0;t<S.length;t++){let n=S[t],s=x(n);k.includes(s)||(e.splice(t,0,n),E.push(n))}"wait"===c&&E.length&&(e=E),L(f(e)),C(y);return}let{forceRender:D}=(0,i.useContext)(l.p);return(0,s.jsx)(s.Fragment,{children:S.map(e=>{let t=x(e),i=(!u||!!p)&&(y===S||k.includes(t));return(0,s.jsx)(h,{isPresent:i,initial:(!j.current||!!a)&&void 0,custom:i?void 0:n,presenceAffectsLayout:d,mode:c,onExitComplete:i?void 0:()=>{if(!w.has(t))return;w.set(t,!0);let e=!0;w.forEach(t=>{t||(e=!1)}),e&&(null==D||D(),L(v.current),u&&(null==b||b()),r&&r())},children:e},t)})})};var y=n(521);function k(){let e=(0,a.useRouter)(),[t,n]=(0,i.useState)([]),[l,o]=(0,i.useState)(""),[r,d]=(0,i.useState)("normal"),[c,u]=(0,i.useState)(""),[h,p]=(0,i.useState)(""),[m,x]=(0,i.useState)(""),[f,g]=(0,i.useState)("all"),[k,j]=(0,i.useState)(null),[v,w]=(0,i.useState)(null),[N,C]=(0,i.useState)(!0),[S,L]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=localStorage.getItem("pookie-tasks");if(e)try{let t=JSON.parse(e);n(t),C(!1)}catch(e){console.error("Failed to parse saved tasks:",e)}E()},[]),(0,i.useEffect)(()=>{t.length>=0&&!N&&localStorage.setItem("pookie-tasks",JSON.stringify(t))},[t,N]);let E=async()=>{try{let t=await fetch("/api/todos");if(401===t.status){e.push("/login");return}let s=await t.json();n(s.tasks||[])}catch(e){console.error("Failed to fetch tasks:",e)}finally{C(!1)}},D=async e=>{if(e.preventDefault(),l.trim()&&!S){L(!0);try{let e={description:l.trim(),priority:r,tags:h.trim()?[h.trim()]:[],dueDate:c||null},s=await fetch("/api/todos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){let e=await s.json();n([...t,e.task]),o(""),d("normal"),u(""),p("")}}catch(e){console.error("Failed to create task:",e)}finally{L(!1)}}},P=async e=>{try{let s=await fetch("/api/todos/".concat(e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:!e.completed})});if(s.ok){let i=await s.json();n(t.map(t=>t.id===e.id?i.task:t))}}catch(e){console.error("Failed to toggle task:",e)}},M=async e=>{if(v!==e){w(e);return}try{(await fetch("/api/todos/".concat(e),{method:"DELETE"})).ok&&(n(t.filter(t=>t.id!==e)),w(null))}catch(e){console.error("Failed to delete task:",e)}},A=async e=>{if(!k||k.id!==e.id){j(e);return}try{let s=await fetch("/api/todos/".concat(e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({description:k.description,priority:k.priority,tags:k.tags,dueDate:k.dueDate})});if(s.ok){let i=await s.json();n(t.map(t=>t.id===e.id?i.task:t)),j(null)}}catch(e){console.error("Failed to update task:",e)}},O=t.filter(e=>("completed"!==f||!!e.completed)&&("pending"!==f||!e.completed)&&(!m||!!e.description.toLowerCase().includes(m.toLowerCase()))),R=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),e.push("/login"),e.refresh()}catch(e){console.error("Logout failed:",e)}};return N?(0,s.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-white text-lg",children:"Loading..."})}):(0,s.jsx)("div",{className:"min-h-screen bg-black p-4 md:p-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("header",{className:"mb-8 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-4xl font-display font-bold text-white",children:"pookie todo"}),(0,s.jsx)("p",{className:"text-gray-400 mt-1",children:"your tasks, organized with love"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>e.push("/analytics"),className:"px-4 py-2 text-sm bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-md hover:from-pink-600 hover:to-purple-700 transition-default font-semibold",children:"\uD83D\uDCCA Analytics"}),(0,s.jsx)("button",{onClick:R,className:"px-4 py-2 text-sm bg-white text-black rounded-md hover:bg-gray-200 transition-default",children:"Logout"})]})]}),(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6",children:(0,s.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("input",{type:"text",value:l,onChange:e=>o(e.target.value),placeholder:"Add a new task...",className:"flex-1 h-12 px-4 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-default text-black"}),(0,s.jsx)("button",{type:"submit",disabled:!l.trim()||S,className:"px-6 h-12 bg-pink-500 text-white font-semibold rounded-md hover:bg-pink-600 hover:-translate-y-0.5 hover:shadow-md active:translate-y-0 disabled:opacity-50 disabled:cursor-not-allowed transition-default",children:S?"Adding...":"Add"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-1",children:"Priority"}),(0,s.jsxs)("select",{value:r,onChange:e=>d(e.target.value),className:"w-full h-10 px-3 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 transition-default text-black",children:[(0,s.jsx)("option",{value:"low",children:"Low"}),(0,s.jsx)("option",{value:"normal",children:"Normal"}),(0,s.jsx)("option",{value:"high",children:"High"}),(0,s.jsx)("option",{value:"critical",children:"Critical"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-1",children:"Deadline"}),(0,s.jsx)("input",{type:"date",value:c,onChange:e=>u(e.target.value),className:"w-full h-10 px-3 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 transition-default text-black"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700 mb-1",children:"Category"}),(0,s.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"e.g., Work, Personal",className:"w-full h-10 px-3 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 transition-default text-black"})]})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 md:p-6 mb-6",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-3",children:[(0,s.jsx)("input",{type:"text",value:m,onChange:e=>x(e.target.value),placeholder:"Search tasks...",className:"flex-1 h-10 px-4 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 transition-default text-black"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>g("all"),className:"px-4 h-10 rounded-md font-medium transition-default ".concat("all"===f?"bg-pink-500 text-white":"bg-gray-100 text-black hover:bg-gray-200"),children:"All"}),(0,s.jsx)("button",{onClick:()=>g("pending"),className:"px-4 h-10 rounded-md font-medium transition-default ".concat("pending"===f?"bg-pink-500 text-white":"bg-gray-100 text-black hover:bg-gray-200"),children:"Pending"}),(0,s.jsx)("button",{onClick:()=>g("completed"),className:"px-4 h-10 rounded-md font-medium transition-default ".concat("completed"===f?"bg-pink-500 text-white":"bg-gray-100 text-black hover:bg-gray-200"),children:"Completed"})]})]})}),t.length>0&&(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-700",children:[t.filter(e=>e.completed).length," of ",t.length," completed"]}),(0,s.jsxs)("span",{className:"text-sm font-semibold text-pink-500",children:[Math.round(t.filter(e=>e.completed).length/t.length*100),"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-pink-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(t.filter(e=>e.completed).length/t.length*100,"%")}})})]}),(0,s.jsx)("div",{className:"space-y-3",children:(0,s.jsx)(b,{mode:"popLayout",children:0===O.length?(0,s.jsxs)(y.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"âœ¨"}),(0,s.jsx)("h3",{className:"text-xl font-display font-semibold text-black mb-2",children:0===t.length?"No tasks yet":"No tasks found"}),(0,s.jsx)("p",{className:"text-gray-600",children:0===t.length?"Add your first task to get started":"Try adjusting your filters"})]}):O.map((e,t)=>{let n=(null==k?void 0:k.id)===e.id,i=v===e.id;return(0,s.jsxs)(y.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},transition:{delay:.05*t},className:"bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition-default",children:[(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("button",{onClick:()=>P(e),className:"w-6 h-6 rounded-full border-2 flex items-center justify-center flex-shrink-0 transition-default mt-1 ".concat(e.completed?"bg-pink-500 border-pink-500":"border-gray-300 hover:border-pink-500"),children:e.completed&&(0,s.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{d:"M5 13l4 4L19 7"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[n?(0,s.jsx)("input",{type:"text",value:k.description,onChange:e=>j({...k,description:e.target.value}),className:"w-full px-3 py-1 bg-white border border-pink-500 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 text-black"}):(0,s.jsx)("p",{className:"font-medium ".concat(e.completed?"line-through text-gray-400":"text-black"),children:e.description}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mt-2",children:[(0,s.jsx)("span",{className:"text-xs px-2 py-1 rounded-full font-medium ".concat("critical"===e.priority?"bg-purple-100 text-purple-700":"high"===e.priority?"bg-red-100 text-red-700":"normal"===e.priority?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:e.priority}),e.tags&&e.tags.length>0&&e.tags.map((e,t)=>(0,s.jsx)("span",{className:"text-xs px-2 py-1 rounded-full bg-pink-100 text-pink-700 font-medium",children:e},t)),e.dueDate&&(0,s.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-black font-medium",children:["\uD83D\uDCC5 ",new Date(e.dueDate).toLocaleDateString()]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>A(e),className:"p-2 rounded-md transition-default ".concat(n?"bg-pink-500 text-white":"text-pink-500 hover:bg-pink-50"),title:n?"Save":"Edit",children:n?(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,s.jsx)("button",{onClick:()=>M(e.id),className:"p-2 rounded-md transition-default ".concat(i?"bg-red-500 text-white":"text-red-500 hover:bg-red-50"),title:i?"Click again to confirm":"Delete",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),i&&(0,s.jsx)("div",{className:"mt-2 text-sm text-red-500 font-medium",children:"Click delete again to confirm"})]},e.id)})})})]})})}}},function(e){e.O(0,[160,971,117,744],function(){return e(e.s=4213)}),_N_E=e.O()}]);