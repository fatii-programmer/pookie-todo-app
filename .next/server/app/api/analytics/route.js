"use strict";(()=>{var t={};t.id=567,t.ids=[567],t.modules={2934:t=>{t.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:t=>{t.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:t=>{t.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:t=>{t.exports=require("crypto")},629:t=>{t.exports=require("fs/promises")},5315:t=>{t.exports=require("path")},2254:t=>{t.exports=require("node:buffer")},6005:t=>{t.exports=require("node:crypto")},7261:t=>{t.exports=require("node:util")},880:(t,e,a)=>{a.r(e),a.d(e,{originalPathname:()=>T,patchFetch:()=>_,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>x,staticGenerationAsyncStorage:()=>D});var n={};a.r(n),a.d(n,{GET:()=>w});var r=a(9303),i=a(8716),o=a(670),s=a(7070),c=a(9178),l=a(4087),d=a(9487);function u(t){return t.toISOString().split("T")[0]}function p(t){let e=new Date;return u(t)===u(e)}function m(t){let e=new Date,a=new Date(e);return a.setDate(a.getDate()-7),t>=a&&t<=e}function f(t){let e=new Date,a=new Date(e);return a.setMonth(a.getMonth()-1),t>=a&&t<=e}async function y(t){let[e,a]=await Promise.all([(0,l.lD)(t),(0,d.Ak)(t)]),n=a.filter(t=>t.completed).length,r=a.length-n,i=a.length>0?n/a.length*100:0,o=e.filter(t=>"todo_created"===t.actionType&&p(new Date(t.timestamp))).length,s=e.filter(t=>"todo_completed"===t.actionType&&p(new Date(t.timestamp))).length,c=e.filter(t=>"todo_created"===t.actionType&&m(new Date(t.timestamp))).length,y=e.filter(t=>"todo_completed"===t.actionType&&m(new Date(t.timestamp))).length,w=e.filter(t=>"todo_created"===t.actionType&&f(new Date(t.timestamp))).length,g=e.filter(t=>"todo_completed"===t.actionType&&f(new Date(t.timestamp))).length,h=[];for(let t of e.filter(t=>"todo_completed"===t.actionType)){let a=e.find(e=>"todo_created"===e.actionType&&e.todoId===t.todoId);if(a){let e=new Date(t.timestamp).getTime()-new Date(a.timestamp).getTime();h.push(e)}}let D=h.length>0?h.reduce((t,e)=>t+e,0)/h.length:null,{current:x,longest:T}=function(t){if(0===t.length)return{current:0,longest:0};let e=t.map(t=>u(t)).filter((t,e,a)=>a.indexOf(t)===e).sort().reverse(),a=0,n=0,r=0,i=u(new Date),o=new Date;for(let t of e)t===u(o)?(r++,(t===i||r>1)&&(a=r),n=Math.max(n,r),o.setDate(o.getDate()-1)):(r=1,(o=new Date(t)).setDate(o.getDate()-1));return{current:a,longest:n}}(e.filter(t=>"todo_completed"===t.actionType).map(t=>new Date(t.timestamp))),_={low:a.filter(t=>"low"===t.priority).length,normal:a.filter(t=>"normal"===t.priority).length,high:a.filter(t=>"high"===t.priority).length,critical:a.filter(t=>"critical"===t.priority).length},v={};a.forEach(t=>{t.tags&&t.tags.length>0&&t.tags.forEach(t=>{v[t]=(v[t]||0)+1})});let S=[],k=new Date;k.setDate(k.getDate()-30);let j={};for(let t=0;t<30;t++){let e=new Date;e.setDate(e.getDate()-t),j[u(e)]={completed:0,created:0}}e.forEach(t=>{let e=new Date(t.timestamp);if(e>=k){let a=u(e);j[a]&&("todo_completed"===t.actionType?j[a].completed++:"todo_created"===t.actionType&&j[a].created++)}}),Object.keys(j).forEach(t=>{S.push({date:t,completed:j[t].completed,created:j[t].created})}),S.sort((t,e)=>t.date.localeCompare(e.date));let I={Sunday:0,Monday:0,Tuesday:0,Wednesday:0,Thursday:0,Friday:0,Saturday:0};e.filter(t=>"todo_completed"===t.actionType).forEach(t=>{let e=new Date(t.timestamp).toLocaleDateString("en-US",{weekday:"long"});I[e]++});let O=Object.keys(I).map(t=>({day:t,count:I[t]})),A=e.slice(-10).reverse().map(t=>({date:new Date(t.timestamp).toLocaleString(),action:t.actionType.replace("_"," "),description:t.metadata?.description||"N/A"}));return{totalTasks:a.length,completedTasks:n,pendingTasks:r,completionRate:i,tasksCreatedToday:o,tasksCompletedToday:s,tasksCreatedThisWeek:c,tasksCompletedThisWeek:y,tasksCreatedThisMonth:w,tasksCompletedThisMonth:g,averageCompletionTime:D,currentStreak:x,longestStreak:T,priorityDistribution:_,categoryStats:v,productivityTrend:S,completionsByDay:O,recentActivity:A}}async function w(){try{let t=await (0,c.Gg)();if(!t)return s.NextResponse.json({error:"Unauthorized"},{status:401});let e=await y(t.userId);return s.NextResponse.json({stats:e})}catch(t){return console.error("Analytics error:",t),s.NextResponse.json({error:"Internal server error"},{status:500})}}let g=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/analytics/route",pathname:"/api/analytics",filename:"route",bundlePath:"app/api/analytics/route"},resolvedPagePath:"C:\\Users\\pte\\Desktop\\hackathon-2\\app\\api\\analytics\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:D,serverHooks:x}=g,T="/api/analytics/route";function _(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:D})}},9178:(t,e,a)=>{a.d(e,{Gg:()=>m,Gv:()=>d,V3:()=>u,c_:()=>l});var n=a(6091),r=a(6176),i=a(1615),o=a(2023),s=a.n(o);let c=new TextEncoder().encode(process.env.JWT_SECRET||"default-secret-change-me");async function l(t){return s().hash(t,10)}async function d(t,e){return s().compare(t,e)}async function u(t){return new n.N({userId:t}).setProtectedHeader({alg:"HS256"}).setExpirationTime("7d").sign(c)}async function p(t){try{return(await (0,r._)(t,c)).payload}catch{return null}}async function m(){let t=(0,i.cookies)(),e=t.get("token")?.value;return e?p(e):null}},9487:(t,e,a)=>{a.d(e,{Ak:()=>y,PR:()=>m,_5:()=>h,gI:()=>w,r4:()=>f,xJ:()=>g});var n=a(629),r=a.n(n),i=a(5315),o=a.n(i),s=a(4087);let c=process.env.DATABASE_PATH||"./data/tasks.json",l=null;async function d(){try{await r().access(c)}catch{let t=o().dirname(c);await r().mkdir(t,{recursive:!0});let e={version:"3.0.0",users:[],tasks:{},metadata:{nextId:{},lastModified:new Date().toISOString()}};await r().writeFile(c,JSON.stringify(e,null,2))}}async function u(){return l||(await d(),l=JSON.parse(await r().readFile(c,"utf-8")))}async function p(t){t.metadata.lastModified=new Date().toISOString(),l=t,await r().writeFile(c,JSON.stringify(t,null,2))}async function m(t){return(await u()).users.find(e=>e.email===t)||null}async function f(t){let e=await u();e.users.push(t),await p(e),await (0,s.ar)("user_signup",t.id,void 0,{email:t.email,createdAt:t.createdAt})}async function y(t){return(await u()).tasks[t]||[]}async function w(t,e){let a=await u();a.tasks[t]||(a.tasks[t]=[],a.metadata.nextId[t]=1);let n=a.metadata.nextId[t];a.metadata.nextId[t]++;let r={...e,id:n};return a.tasks[t].push(r),await p(a),await (0,s.ar)("todo_created",t,r.id,{description:r.description,priority:r.priority,tags:r.tags}),r}async function g(t,e,a){let n=await u(),r=n.tasks[t]||[],i=r.findIndex(t=>t.id===e);if(-1===i)return null;let o=r[i],c={...o,...a,id:e};return n.tasks[t][i]=c,await p(n),void 0!==a.completed?a.completed&&!o.completed?await (0,s.ar)("todo_completed",t,e,{description:c.description}):!a.completed&&o.completed&&await (0,s.ar)("todo_uncompleted",t,e,{description:c.description}):await (0,s.ar)("todo_updated",t,e,{updates:a,description:c.description}),c}async function h(t,e){let a=await u(),n=a.tasks[t]||[],r=n.findIndex(t=>t.id===e);if(-1===r)return!1;let i=n[r];return a.tasks[t].splice(r,1),await p(a),await (0,s.ar)("todo_deleted",t,e,{description:i.description}),!0}},4087:(t,e,a)=>{a.d(e,{ar:()=>u,lD:()=>m});var n=a(629),r=a.n(n),i=a(5315),o=a.n(i);let s=process.env.HISTORY_PATH||"./history";async function c(){try{await r().access(s)}catch{await r().mkdir(s,{recursive:!0})}}async function l(t){await c();let e=o().join(s,t);try{let t=await r().readFile(e,"utf-8");return JSON.parse(t)}catch{return[]}}async function d(t,e){await c();let a=o().join(s,t);await r().writeFile(a,JSON.stringify(e,null,2))}async function u(t,e,a,n){let r;let i={id:`${Date.now()}-${Math.random().toString(36).substring(2,9)}`,timestamp:new Date().toISOString(),userId:e,actionType:t,todoId:a,metadata:n};r="user_signup"===t||"user_login"===t||"user_logout"===t?"login-history.json":"todo-history.json";let o=await l(r);return o.push(i),await d(r,o),await p(e,i),i}async function p(t,e){let a=o().join(s,"users");try{await r().access(a)}catch{await r().mkdir(a,{recursive:!0})}let n=o().join(a,`${t}.json`),i=[];try{let t=await r().readFile(n,"utf-8");i=JSON.parse(t)}catch{}i.push(e),await r().writeFile(n,JSON.stringify(i,null,2))}async function m(t,e){let a=await l("todo-history.json");return t&&(a=a.filter(e=>e.userId===t)),void 0!==e&&(a=a.filter(t=>t.todoId===e)),a}}};var e=require("../../../webpack-runtime.js");e.C(t);var a=t=>e(e.s=t),n=e.X(0,[276,881,972],()=>a(880));module.exports=n})();