"use strict";(()=>{var t={};t.id=110,t.ids=[110],t.modules={2934:t=>{t.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:t=>{t.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:t=>{t.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:t=>{t.exports=require("crypto")},629:t=>{t.exports=require("fs/promises")},5315:t=>{t.exports=require("path")},2254:t=>{t.exports=require("node:buffer")},6005:t=>{t.exports=require("node:crypto")},7261:t=>{t.exports=require("node:util")},435:(t,e,r)=>{r.r(e),r.d(e,{originalPathname:()=>x,patchFetch:()=>m,requestAsyncStorage:()=>f,routeModule:()=>p,serverHooks:()=>y,staticGenerationAsyncStorage:()=>w});var a={};r.r(a),r.d(a,{DELETE:()=>l,PATCH:()=>d});var n=r(9303),s=r(8716),i=r(670),o=r(7070),u=r(9178),c=r(9487);async function d(t,{params:e}){try{let r=await (0,u.Gg)();if(!r)return o.NextResponse.json({error:"Unauthorized"},{status:401});let a=parseInt(e.id);if(isNaN(a))return o.NextResponse.json({error:"Invalid task ID"},{status:400});let n=await t.json(),s=await (0,c.xJ)(r.userId,a,n);if(!s)return o.NextResponse.json({error:"Task not found"},{status:404});return o.NextResponse.json({task:s})}catch(t){return console.error("Update task error:",t),o.NextResponse.json({error:"Internal server error"},{status:500})}}async function l(t,{params:e}){try{let t=await (0,u.Gg)();if(!t)return o.NextResponse.json({error:"Unauthorized"},{status:401});let r=parseInt(e.id);if(isNaN(r))return o.NextResponse.json({error:"Invalid task ID"},{status:400});if(!await (0,c._5)(t.userId,r))return o.NextResponse.json({error:"Task not found"},{status:404});return o.NextResponse.json({success:!0})}catch(t){return console.error("Delete task error:",t),o.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/todos/[id]/route",pathname:"/api/todos/[id]",filename:"route",bundlePath:"app/api/todos/[id]/route"},resolvedPagePath:"C:\\Users\\pte\\Desktop\\hackathon-2\\app\\api\\todos\\[id]\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:f,staticGenerationAsyncStorage:w,serverHooks:y}=p,x="/api/todos/[id]/route";function m(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:w})}},9178:(t,e,r)=>{r.d(e,{Gg:()=>f,Gv:()=>d,V3:()=>l,c_:()=>c});var a=r(6091),n=r(6176),s=r(1615),i=r(2023),o=r.n(i);let u=new TextEncoder().encode(process.env.JWT_SECRET||"default-secret-change-me");async function c(t){return o().hash(t,10)}async function d(t,e){return o().compare(t,e)}async function l(t){return new a.N({userId:t}).setProtectedHeader({alg:"HS256"}).setExpirationTime("7d").sign(u)}async function p(t){try{return(await (0,n._)(t,u)).payload}catch{return null}}async function f(){let t=(0,s.cookies)(),e=t.get("token")?.value;return e?p(e):null}},9487:(t,e,r)=>{r.d(e,{Ak:()=>y,PR:()=>f,_5:()=>g,gI:()=>x,r4:()=>w,xJ:()=>m});var a=r(629),n=r.n(a),s=r(5315),i=r.n(s),o=r(4087);let u=process.env.DATABASE_PATH||"./data/tasks.json",c=null;async function d(){try{await n().access(u)}catch{let t=i().dirname(u);await n().mkdir(t,{recursive:!0});let e={version:"3.0.0",users:[],tasks:{},metadata:{nextId:{},lastModified:new Date().toISOString()}};await n().writeFile(u,JSON.stringify(e,null,2))}}async function l(){return c||(await d(),c=JSON.parse(await n().readFile(u,"utf-8")))}async function p(t){t.metadata.lastModified=new Date().toISOString(),c=t,await n().writeFile(u,JSON.stringify(t,null,2))}async function f(t){return(await l()).users.find(e=>e.email===t)||null}async function w(t){let e=await l();e.users.push(t),await p(e),await (0,o.ar)("user_signup",t.id,void 0,{email:t.email,createdAt:t.createdAt})}async function y(t){return(await l()).tasks[t]||[]}async function x(t,e){let r=await l();r.tasks[t]||(r.tasks[t]=[],r.metadata.nextId[t]=1);let a=r.metadata.nextId[t];r.metadata.nextId[t]++;let n={...e,id:a};return r.tasks[t].push(n),await p(r),await (0,o.ar)("todo_created",t,n.id,{description:n.description,priority:n.priority,tags:n.tags}),n}async function m(t,e,r){let a=await l(),n=a.tasks[t]||[],s=n.findIndex(t=>t.id===e);if(-1===s)return null;let i=n[s],u={...i,...r,id:e};return a.tasks[t][s]=u,await p(a),void 0!==r.completed?r.completed&&!i.completed?await (0,o.ar)("todo_completed",t,e,{description:u.description}):!r.completed&&i.completed&&await (0,o.ar)("todo_uncompleted",t,e,{description:u.description}):await (0,o.ar)("todo_updated",t,e,{updates:r,description:u.description}),u}async function g(t,e){let r=await l(),a=r.tasks[t]||[],n=a.findIndex(t=>t.id===e);if(-1===n)return!1;let s=a[n];return r.tasks[t].splice(n,1),await p(r),await (0,o.ar)("todo_deleted",t,e,{description:s.description}),!0}},4087:(t,e,r)=>{r.d(e,{ar:()=>l,lD:()=>f});var a=r(629),n=r.n(a),s=r(5315),i=r.n(s);let o=process.env.HISTORY_PATH||"./history";async function u(){try{await n().access(o)}catch{await n().mkdir(o,{recursive:!0})}}async function c(t){await u();let e=i().join(o,t);try{let t=await n().readFile(e,"utf-8");return JSON.parse(t)}catch{return[]}}async function d(t,e){await u();let r=i().join(o,t);await n().writeFile(r,JSON.stringify(e,null,2))}async function l(t,e,r,a){let n;let s={id:`${Date.now()}-${Math.random().toString(36).substring(2,9)}`,timestamp:new Date().toISOString(),userId:e,actionType:t,todoId:r,metadata:a};n="user_signup"===t||"user_login"===t||"user_logout"===t?"login-history.json":"todo-history.json";let i=await c(n);return i.push(s),await d(n,i),await p(e,s),s}async function p(t,e){let r=i().join(o,"users");try{await n().access(r)}catch{await n().mkdir(r,{recursive:!0})}let a=i().join(r,`${t}.json`),s=[];try{let t=await n().readFile(a,"utf-8");s=JSON.parse(t)}catch{}s.push(e),await n().writeFile(a,JSON.stringify(s,null,2))}async function f(t,e){let r=await c("todo-history.json");return t&&(r=r.filter(e=>e.userId===t)),void 0!==e&&(r=r.filter(t=>t.todoId===e)),r}}};var e=require("../../../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),a=e.X(0,[276,881,972],()=>r(435));module.exports=a})();